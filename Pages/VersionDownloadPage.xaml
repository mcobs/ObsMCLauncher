<Page x:Class="ObsMCLauncher.Pages.VersionDownloadPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      mc:Ignorable="d" 
      d:DesignHeight="700" d:DesignWidth="900"
      Background="{StaticResource BackgroundBrush}">

    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 标题区域 -->
        <StackPanel Grid.Row="0">
            <TextBlock Text="版本下载" 
                     FontSize="28" 
                     FontWeight="Bold"
                     Margin="0,0,0,10"/>
            <TextBlock Text="选择想要下载的 Minecraft 版本，点击进入配置加载器选项" 
                     FontSize="14" 
                     Foreground="{StaticResource TextSecondaryBrush}"
                     Margin="0,0,0,25"/>
        </StackPanel>

        <!-- 筛选和搜索区域 -->
        <Border Grid.Row="1"
                Background="{StaticResource SurfaceBrush}"
                CornerRadius="10"
                Padding="20"
                Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- 搜索框 -->
                <TextBox Grid.Column="0"
                       x:Name="SearchBox"
                       materialDesign:HintAssist.Hint="搜索版本号..."
                       Style="{StaticResource MaterialDesignOutlinedTextBox}"
                       Margin="0,0,15,0"
                       TextChanged="SearchBox_TextChanged">
                    <TextBox.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="8"/>
                        </Style>
                    </TextBox.Resources>
                </TextBox>

                <!-- 版本类型筛选 -->
                <ComboBox Grid.Column="1"
                        x:Name="VersionTypeComboBox"
                        Width="150"
                        materialDesign:HintAssist.Hint="版本类型"
                        Style="{StaticResource MaterialDesignOutlinedComboBox}"
                        Margin="0,0,15,0"
                        SelectionChanged="VersionTypeComboBox_SelectionChanged">
                    <ComboBoxItem Content="全部版本" IsSelected="True"/>
                    <ComboBoxItem Content="正式版"/>
                    <ComboBoxItem Content="快照版"/>
                    <ComboBoxItem Content="远古版"/>
                </ComboBox>

                <!-- 刷新按钮 -->
                <Button x:Name="RefreshButton"
                      Grid.Column="2"
                      Style="{StaticResource MaterialDesignIconButton}"
                      ToolTip="刷新版本列表"
                      Click="RefreshButton_Click">
                    <materialDesign:PackIcon Kind="Refresh" Width="24" Height="24"/>
                </Button>
            </Grid>
        </Border>

        <!-- 版本列表 -->
        <Border Grid.Row="2"
                Background="{StaticResource SurfaceBrush}"
                CornerRadius="10">
            <Grid>
                <!-- 加载指示器 -->
                <StackPanel x:Name="LoadingPanel"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Visibility="Collapsed">
                    
                    <!-- 使用 Material Design 的 ProgressBar 作为加载动画 -->
                    <materialDesign:Card Width="300" 
                                        Padding="32"
                                        UniformCornerRadius="10">
                        <StackPanel>
                            <ProgressBar Style="{StaticResource MaterialDesignCircularProgressBar}"
                                       Value="0"
                                       IsIndeterminate="True"
                                       Width="64"
                                       Height="64"
                                       HorizontalAlignment="Center"/>
                            
                            <TextBlock Text="加载版本列表中..."
                                     FontSize="16"
                                     Margin="0,20,0,0"
                                     HorizontalAlignment="Center"
                                     Foreground="{StaticResource TextBrush}"/>
                            
                            <TextBlock x:Name="LoadingDetailText"
                                     Text="正在从服务器获取数据..."
                                     FontSize="12"
                                     Margin="0,8,0,0"
                                     HorizontalAlignment="Center"
                                     Foreground="{StaticResource TextSecondaryBrush}"/>
                                </StackPanel>
                    </materialDesign:Card>
                </StackPanel>

                <!-- 版本列表滚动区域 -->
                <ScrollViewer x:Name="VersionScrollViewer"
                            VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="VersionListPanel" Margin="0,10">
                        <!-- 动态生成版本项 -->
                </StackPanel>
            </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</Page>
