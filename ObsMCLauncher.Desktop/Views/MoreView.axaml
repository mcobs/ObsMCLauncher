<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:ObsMCLauncher.Desktop.ViewModels"
             xmlns:converters="using:ObsMCLauncher.Desktop.Converters"
             x:Class="ObsMCLauncher.Desktop.Views.MoreView"
             x:DataType="vm:MoreViewModel"
             x:Name="MoreViewControl">

  <Grid RowDefinitions="Auto,*">
    <Border Grid.Row="0"
            Background="{DynamicResource SurfaceBrush}"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="0,0,0,1"
            Padding="24,12"
            Height="60">
      <TabControl SelectedIndex="{Binding SelectedTabIndex}"
                  Background="Transparent"
                  BorderThickness="0"
                  Padding="0"
                  ItemsSource="{Binding Tabs}">
        <TabControl.ItemTemplate>
          <DataTemplate x:DataType="vm:TabItemViewModel">
            <Border CornerRadius="6"
                    Background="Transparent"
                    Padding="16,8">
              <TextBlock Text="{Binding Header}"
                         FontSize="14"
                         FontWeight="SemiBold"/>
            </Border>
          </DataTemplate>
        </TabControl.ItemTemplate>
        <TabControl.ContentTemplate>
          <DataTemplate x:DataType="vm:TabItemViewModel">
            <ContentPresenter Content="{Binding Content}"/>
          </DataTemplate>
        </TabControl.ContentTemplate>

        <TabControl.Styles>
          <Style Selector="TabItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
          </Style>

          <Style Selector="TabItem:selected /template/ Border">
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
          </Style>

          <Style Selector="TabItem:selected /template/ Border TextBlock">
            <Setter Property="Foreground" Value="White"/>
          </Style>

          <Style Selector="TabItem:pointerover /template/ Border">
            <Setter Property="Background" Value="{DynamicResource SurfaceHoverBrush}"/>
          </Style>
        </TabControl.Styles>
      </TabControl>
    </Border>

    <Grid Grid.Row="1">
      <ScrollViewer VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled"
                    Padding="24">
        <ScrollViewer.IsVisible>
          <MultiBinding Converter="{x:Static converters:TabContentTypeConverter.Instance}" ConverterParameter="AboutViewModel">
            <Binding Path="#MoreViewControl.DataContext.Tabs"/>
            <Binding Path="#MoreViewControl.DataContext.SelectedTabIndex"/>
          </MultiBinding>
        </ScrollViewer.IsVisible>
        <StackPanel MaxWidth="800" DataContext="{Binding About}">
          <Border Background="{DynamicResource SurfaceElevatedBrush}"
                  CornerRadius="10" Padding="20" Margin="0,0,0,16">
            <StackPanel HorizontalAlignment="Center">
              <Image Source="avares://ObsMCLauncher.Desktop/Assets/logo.png"
                     Width="140" Height="140" Margin="0,0,0,24"
                     Stretch="Uniform"/>

              <TextBlock Text="ObsMCLauncher"
                         FontSize="32" FontWeight="Bold"
                         HorizontalAlignment="Center" Margin="0,0,0,8"
                         PointerPressed="TitleText_PointerPressed"/>

              <TextBlock Text="é»‘æ›œçŸ³ Minecraft å¯åŠ¨å™¨"
                         FontSize="16" Foreground="{DynamicResource TextSecondaryBrush}"
                         HorizontalAlignment="Center" Margin="0,0,0,16"/>

              <TextBlock Text="{Binding VersionText}"
                         FontSize="14" Foreground="{DynamicResource TextTertiaryBrush}"
                         HorizontalAlignment="Center" Margin="0,0,0,12"/>

              <Button Command="{Binding CheckUpdateCommand}"
                      IsEnabled="{Binding !IsCheckingUpdate}"
                      Height="32" Padding="20,0" HorizontalAlignment="Center">
                <StackPanel Orientation="Horizontal">
                  <TextBlock Text="ðŸ”„" FontSize="16" Margin="0,0,8,0"/>
                  <TextBlock Text="æ£€æŸ¥æ›´æ–°" VerticalAlignment="Center" FontSize="13"/>
                </StackPanel>
              </Button>
            </StackPanel>
          </Border>

          <Border Background="{DynamicResource SurfaceElevatedBrush}"
                  CornerRadius="10" Padding="20" Margin="0,0,0,16">
            <Grid ColumnDefinitions="*,12,*">
              <!-- ç›¸å…³é“¾æŽ¥ -->
              <StackPanel Grid.Column="0">
                <TextBlock Text="ç›¸å…³é“¾æŽ¥" FontSize="16" FontWeight="Bold" Margin="0,0,0,12"/>

                <Button Command="{Binding OpenGitHubCommand}"
                        Background="{DynamicResource SurfaceBrush}"
                        HorizontalContentAlignment="Left"
                        Padding="12,10" Margin="0,0,0,8" CornerRadius="6" HorizontalAlignment="Stretch">
                  <StackPanel Orientation="Horizontal">
                    <TextBlock Text="ðŸ”—" FontSize="16" Margin="0,0,8,0"/>
                    <StackPanel>
                      <TextBlock Text="GitHub å¼€æºä»“åº“" FontWeight="SemiBold"/>
                      <TextBlock Text="github.com/mcobs/ObsMCLauncher"
                                 FontSize="11" Foreground="{DynamicResource TextTertiaryBrush}" Margin="0,2,0,0"/>
                    </StackPanel>
                  </StackPanel>
                </Button>

                <Button Command="{Binding OpenForumCommand}"
                        Background="{DynamicResource SurfaceBrush}"
                        HorizontalContentAlignment="Left"
                        Padding="12,10" Margin="0,0,0,8" CornerRadius="6" HorizontalAlignment="Stretch">
                  <StackPanel Orientation="Horizontal">
                    <TextBlock Text="ðŸŒ" FontSize="16" Margin="0,0,8,0"/>
                    <StackPanel>
                      <TextBlock Text="é»‘æ›œçŸ³è®ºå›" FontWeight="SemiBold"/>
                      <TextBlock Text="mcobs.cn"
                                 FontSize="11" Foreground="{DynamicResource TextTertiaryBrush}" Margin="0,2,0,0"/>
                    </StackPanel>
                  </StackPanel>
                </Button>

                <Button Command="{Binding OpenMciLmLinkCommand}"
                        Background="{DynamicResource SurfaceBrush}"
                        HorizontalContentAlignment="Left"
                        Padding="12,10" CornerRadius="6" HorizontalAlignment="Stretch">
                  <StackPanel Orientation="Horizontal">
                    <TextBlock Text="ðŸ”—" FontSize="16" Margin="0,0,8,0"/>
                    <StackPanel>
                      <TextBlock Text="MciLm-link" FontWeight="SemiBold"/>
                      <TextBlock Text="link.mcilm.top"
                                 FontSize="11" Foreground="{DynamicResource TextTertiaryBrush}" Margin="0,2,0,0"/>
                    </StackPanel>
                  </StackPanel>
                </Button>
              </StackPanel>

              <!-- ç‰¹åˆ«æ„Ÿè°¢ -->
              <StackPanel Grid.Column="2">
                <TextBlock Text="ç‰¹åˆ«æ„Ÿè°¢" FontSize="16" FontWeight="Bold" Margin="0,0,0,12"/>

                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="6" Padding="12" Margin="0,0,0,8">
                  <StackPanel>
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="ðŸ’" FontSize="16" Margin="0,0,6,0"/>
                      <TextBlock Text="bangbang93" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="BMCLAPI é•œåƒæºæœåŠ¡"
                               FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"
                               Margin="22,4,0,0" TextWrapping="Wrap"/>
                  </StackPanel>
                </Border>

                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="6" Padding="12" Margin="0,0,0,8">
                  <StackPanel>
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="ðŸŽ¨" FontSize="16" Margin="0,0,6,0"/>
                      <TextBlock Text="è·¯è¿‡çš„äº¬å±€DF7C" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="è½¯ä»¶å›¾æ ‡è®¾è®¡"
                               FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"
                               Margin="22,4,0,0" TextWrapping="Wrap"/>
                  </StackPanel>
                </Border>

                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="6" Padding="12" Margin="0,0,0,8">
                  <StackPanel>
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="ðŸŒ" FontSize="16" Margin="0,0,6,0"/>
                      <TextBlock Text="MciLm-link" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="å¤šäººè”æœº/å†…ç½‘ç©¿é€æœåŠ¡"
                               FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"
                               Margin="22,4,0,0" TextWrapping="Wrap"/>
                  </StackPanel>
                </Border>

                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="6" Padding="12">
                  <StackPanel>
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="ðŸ”" FontSize="16" Margin="0,0,6,0"/>
                      <TextBlock Text="authlib-injector" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="Yggdrasil å¤–ç½®ç™»å½•æ”¯æŒ"
                               FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"
                               Margin="22,4,0,0" TextWrapping="Wrap"/>
                  </StackPanel>
                </Border>
              </StackPanel>
            </Grid>
          </Border>

          <Border Background="{DynamicResource SurfaceElevatedBrush}"
                  CornerRadius="10" Padding="20" Margin="0,0,0,16">
            <StackPanel>
              <TextBlock Text="å…³äºŽ" FontSize="16" FontWeight="Bold" Margin="0,0,0,12"/>
              <TextBlock Text="ObsMCLauncher æ˜¯ä¸€æ¬¾çŽ°ä»£åŒ–çš„ Minecraft å¯åŠ¨å™¨ï¼Œé‡‡ç”¨ .NET 8.0 å’Œ Avalonia æŠ€æœ¯å¼€å‘ï¼Œæä¾›æµç•…çš„æ¸¸æˆç®¡ç†ä½“éªŒã€‚"
                         FontSize="14" Foreground="{DynamicResource TextSecondaryBrush}"
                         TextWrapping="Wrap" LineHeight="22" Margin="0,0,0,16"/>

              <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                <TextBlock Text="å¼€æºåè®®ï¼š" FontSize="14" Foreground="{DynamicResource TextTertiaryBrush}" Width="80"/>
                <TextBlock Text="GNU GPL v3.0" FontSize="14"/>
              </StackPanel>

              <StackPanel Orientation="Horizontal">
                <TextBlock Text="æŠ€æœ¯æ ˆï¼š" FontSize="14" Foreground="{DynamicResource TextTertiaryBrush}" Width="80"/>
                <TextBlock Text=".NET 8.0 | Avalonia | C#" FontSize="14"/>
              </StackPanel>
            </StackPanel>
          </Border>

          <Border Background="{DynamicResource SurfaceElevatedBrush}"
                  CornerRadius="10" Padding="20" Margin="0,0,0,16">
            <StackPanel>
              <TextBlock Text="âš ï¸ å…è´£å£°æ˜Ž" FontSize="16" FontWeight="Bold"
                         Foreground="{DynamicResource PrimaryBrush}" Margin="0,0,0,12"/>
              <TextBlock FontSize="13" Foreground="{DynamicResource TextSecondaryBrush}"
                         TextWrapping="Wrap" LineHeight="20">
                <Run Text="æœ¬å¯åŠ¨å™¨ä¸ºç¬¬ä¸‰æ–¹å·¥å…·ï¼Œä¸Ž Mojang Studios å’Œ Microsoft æ— å…³ã€‚"/>
                <LineBreak/>
                <Run Text="Minecraft æ˜¯ Mojang Studios çš„æ³¨å†Œå•†æ ‡ã€‚"/>
                <LineBreak/>
                <Run Text="ä½¿ç”¨æœ¬è½¯ä»¶å³è¡¨ç¤ºæ‚¨åŒæ„è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨é£Žé™©ã€‚"/>
              </TextBlock>
            </StackPanel>
          </Border>

          <TextBlock Text="Â© 2025 ObsMCLauncher - ä½¿ç”¨ â¤ï¸ å’Œ C# æž„å»º"
                     FontSize="12" Foreground="{DynamicResource TextTertiaryBrush}"
                     HorizontalAlignment="Center" Margin="0,8,0,20"/>
        </StackPanel>
      </ScrollViewer>

      <Grid DataContext="{Binding Plugins}">
        <Grid.IsVisible>
          <MultiBinding Converter="{x:Static converters:TabContentTypeConverter.Instance}" ConverterParameter="PluginsViewModel">
            <Binding Path="#MoreViewControl.DataContext.Tabs"/>
            <Binding Path="#MoreViewControl.DataContext.SelectedTabIndex"/>
          </MultiBinding>
        </Grid.IsVisible>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
          <Grid Margin="24">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="420"/>
            <ColumnDefinition Width="16"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <Border Grid.Column="0" Background="{DynamicResource SurfaceBrush}" CornerRadius="8" Padding="16">
            <Grid RowDefinitions="Auto,Auto,*">
              <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                <RadioButton Content="å¸‚åœº"
                             IsChecked="{Binding CurrentTab, Converter={x:Static converters:PluginTabToBoolConverter.Instance}, ConverterParameter=Market}"
                             Padding="16,6" FontSize="13"/>
                <RadioButton Content="å·²å®‰è£…"
                             IsChecked="{Binding CurrentTab, Converter={x:Static converters:PluginTabToBoolConverter.Instance}, ConverterParameter=Installed}"
                             Padding="16,6" FontSize="13" Margin="8,0,0,0"/>
              </StackPanel>

              <Grid Grid.Row="1" Margin="0,0,0,12" IsVisible="{Binding IsMarket}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox Grid.Column="0" Text="{Binding SearchText}" Watermark="æœç´¢æ’ä»¶..." Margin="0,0,8,0"/>
                <ComboBox Grid.Column="1" ItemsSource="{Binding PlatformFilters}" 
                          SelectedItem="{Binding SelectedPlatformFilter}"
                          Width="120">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding DisplayName}"/>
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </Grid>

              <Grid Grid.Row="2">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                  <ListBox ItemsSource="{Binding LeftItems}"
                           SelectedItem="{Binding SelectedItem}"
                           Background="Transparent"
                           BorderThickness="0">
                    <ListBox.ItemTemplate>
                      <DataTemplate>
                        <Border CornerRadius="8" Padding="12" Margin="0,0,0,8"
                                Background="{DynamicResource SurfaceElevatedBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1">
                          <Grid ColumnDefinitions="Auto,*,Auto">
                            <Border Grid.Column="0" Width="32" Height="32" CornerRadius="6" Margin="0,0,10,0"
                                    Background="{DynamicResource SurfaceBrush}"
                                    IsVisible="{Binding IconUrl, Converter={x:Static converters:PluginIconVisibleConverter.Instance}}">
                              <Image Source="{Binding IconUrl, Converter={x:Static converters:PluginIconConverter.Instance}}"
                                     Stretch="UniformToFill"/>
                            </Border>
                            <StackPanel Grid.Column="1">
                              <TextBlock Text="{Binding Title}" FontSize="13" FontWeight="SemiBold"/>
                              <TextBlock Text="{Binding Meta}" FontSize="11" Margin="0,2,0,0"
                                         Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <TextBlock Grid.Column="2" Text="!" FontSize="14" FontWeight="Bold"
                                       Foreground="#FF4747" VerticalAlignment="Center"
                                       IsVisible="{Binding HasError}"/>
                          </Grid>
                        </Border>
                      </DataTemplate>
                    </ListBox.ItemTemplate>
                  </ListBox>
                </ScrollViewer>

                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" IsVisible="{Binding IsMarketLoading}">
                  <ProgressBar IsIndeterminate="True" Width="100"/>
                  <TextBlock Text="åŠ è½½ä¸­..." FontSize="13" Margin="0,8,0,0" 
                             Foreground="{DynamicResource TextSecondaryBrush}"/>
                </StackPanel>

                <TextBlock Text="{Binding MarketError}" FontSize="13"
                           VerticalAlignment="Center" HorizontalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}"
                           IsVisible="{Binding MarketError, Converter={x:Static converters:NotNullConverter.Instance}}"/>
              </Grid>
            </Grid>
          </Border>

          <Border Grid.Column="2" Background="{DynamicResource SurfaceBrush}" CornerRadius="8" Padding="16">
            <Grid RowDefinitions="Auto,Auto,Auto,*">
              <TextBlock Grid.Row="0" Text="{Binding Detail.Title}" FontSize="18" FontWeight="Bold" Margin="0,0,0,4"/>
              <TextBlock Grid.Row="1" Text="{Binding Detail.Meta}" FontSize="12"
                         Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,12"/>

              <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,12">
                <Button Content="{Binding Detail.PrimaryActionText}"
                        Command="{Binding PrimaryActionCommand}"
                        IsEnabled="{Binding Detail.PrimaryActionEnabled}"
                        IsVisible="{Binding Detail.PrimaryActionVisible}"
                        Background="{DynamicResource PrimaryBrush}"
                        Height="32" Padding="16,0"/>
                <Button Content="{Binding Detail.SecondaryActionText}"
                        Command="{Binding SecondaryActionCommand}"
                        IsVisible="{Binding Detail.SecondaryActionVisible}"
                        Height="32" Padding="16,0" Margin="10,0,0,0"/>
                <Button Content="ä¸»é¡µ"
                        Command="{Binding OpenHomeCommand}"
                        IsVisible="{Binding Detail.HomeVisible}"
                        Height="32" Padding="12,0" Margin="10,0,0,0"/>
                <Button Content="ä»“åº“"
                        Command="{Binding OpenRepoCommand}"
                        IsVisible="{Binding Detail.RepoVisible}"
                        Height="32" Padding="12,0" Margin="6,0,0,0"/>
              </StackPanel>

              <TabControl Grid.Row="3" Background="Transparent" BorderThickness="0" Margin="-8,0,-8,-8">
                <TabItem Header="è¯¦æƒ…" Padding="8,2">
                  <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="420">
                    <TextBlock Text="{Binding Detail.Description}" TextWrapping="Wrap"
                               Foreground="{DynamicResource TextSecondaryBrush}" FontSize="13" Margin="8"/>
                  </ScrollViewer>
                </TabItem>
                <TabItem Header="è¾“å‡º" Padding="8,2" IsVisible="{Binding Detail.OutputVisible}">
                  <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="420">
                    <TextBlock Text="{Binding Detail.Output}" TextWrapping="Wrap"
                               Foreground="{DynamicResource TextSecondaryBrush}" FontSize="12" Margin="8"/>
                  </ScrollViewer>
                </TabItem>
              </TabControl>
            </Grid>
          </Border>
        </Grid>
        </ScrollViewer>
      </Grid>

      <Grid DataContext="{Binding Screenshots}">
        <Grid.IsVisible>
          <MultiBinding Converter="{x:Static converters:TabContentTypeConverter.Instance}" ConverterParameter="ScreenshotsViewModel">
            <Binding Path="#MoreViewControl.DataContext.Tabs"/>
            <Binding Path="#MoreViewControl.DataContext.SelectedTabIndex"/>
          </MultiBinding>
        </Grid.IsVisible>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="{DynamicResource SurfaceBrush}"
                CornerRadius="10" Padding="20" Margin="24,24,24,16">
          <Grid ColumnDefinitions="*,Auto,Auto,Auto">
            <TextBox Grid.Column="0" Text="{Binding SearchText}"
                     Watermark="æœç´¢æˆªå›¾..." Margin="0,0,12,0"/>
            <ComboBox Grid.Column="1" ItemsSource="{Binding Versions}"
                      SelectedItem="{Binding SelectedVersion}"
                      Width="150" Margin="0,0,12,0"/>
            <CalendarDatePicker Grid.Column="2" SelectedDate="{Binding StartDate}"
                               Width="140" Margin="0,0,8,0"/>
            <CalendarDatePicker Grid.Column="3" SelectedDate="{Binding EndDate}"
                               Width="140" Margin="0,0,12,0"/>
          </Grid>
        </Border>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="24,0,24,24">
          <ItemsControl ItemsSource="{Binding Screenshots}">
            <ItemsControl.ItemsPanel>
              <ItemsPanelTemplate>
                <WrapPanel Orientation="Horizontal"/>
              </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="12" Padding="8" Margin="0,0,16,16" Width="200">
                  <Grid RowDefinitions="150,Auto,Auto,Auto">
                    <Border Grid.Row="0" CornerRadius="8" Background="#2C2C2C" Margin="0,0,0,8">
                      <Image Source="{Binding FullPath}" Stretch="UniformToFill"/>
                    </Border>
                    <TextBlock Grid.Row="1" Text="{Binding FileName}" FontSize="13"
                               FontWeight="SemiBold" TextTrimming="CharacterEllipsis" Margin="0,0,0,4"/>
                    <StackPanel Grid.Row="2" Margin="0,0,0,8">
                      <TextBlock FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2">
                        <Run Text="å¤§å°: "/><Run Text="{Binding FormattedSize}"/>
                      </TextBlock>
                      <TextBlock FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}">
                        <Run Text="åˆ›å»º: "/><Run Text="{Binding FormattedCreatedTime}"/>
                      </TextBlock>
                    </StackPanel>
                    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
                      <Button Content="æŸ¥çœ‹" Padding="8,4" Margin="0,0,4,0"
                              Command="{Binding $parent[ItemsControl].((vm:ScreenshotsViewModel)DataContext).ViewScreenshotCommand}"
                              CommandParameter="{Binding}"/>
                      <Button Content="åˆ é™¤" Padding="8,4" Foreground="#DC3545"
                              Command="{Binding $parent[ItemsControl].((vm:ScreenshotsViewModel)DataContext).DeleteScreenshotCommand}"
                              CommandParameter="{Binding}"/>
                    </StackPanel>
                  </Grid>
                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </ScrollViewer>

        <StackPanel Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center"
                    IsVisible="{Binding IsEmpty}">
          <TextBlock Text="ðŸ“·" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16"
                     Foreground="{DynamicResource TextSecondaryBrush}"/>
          <TextBlock Text="æš‚æ— æˆªå›¾" FontSize="18" FontWeight="SemiBold"
                     HorizontalAlignment="Center" Margin="0,0,0,8"
                     Foreground="{DynamicResource TextSecondaryBrush}"/>
          <TextBlock Text="æ‚¨è¿˜æ²¡æœ‰ä»»ä½•æ¸¸æˆæˆªå›¾" FontSize="13"
                     HorizontalAlignment="Center"
                     Foreground="{DynamicResource TextTertiaryBrush}"/>
        </StackPanel>
          </Grid>
        </ScrollViewer>
      </Grid>

      <Grid DataContext="{Binding Servers}">
        <Grid.IsVisible>
          <MultiBinding Converter="{x:Static converters:TabContentTypeConverter.Instance}" ConverterParameter="ServersViewModel">
            <Binding Path="#MoreViewControl.DataContext.Tabs"/>
            <Binding Path="#MoreViewControl.DataContext.SelectedTabIndex"/>
          </MultiBinding>
        </Grid.IsVisible>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="{DynamicResource SurfaceBrush}"
                CornerRadius="10" Padding="20" Margin="24,24,24,16">
          <Grid ColumnDefinitions="*,Auto,Auto,Auto">
            <TextBox Grid.Column="0" Text="{Binding SearchText}"
                     Watermark="æœç´¢æœåŠ¡å™¨..." Margin="0,0,12,0"/>
            <ComboBox Grid.Column="1" ItemsSource="{Binding Groups}"
                      SelectedItem="{Binding SelectedGroup}"
                      Width="150" Margin="0,0,12,0"/>
            <Button Grid.Column="2" Content="åˆ·æ–°çŠ¶æ€"
                    Command="{Binding RefreshStatusCommand}" Margin="0,0,12,0"/>
            <Button Grid.Column="3" Content="æ·»åŠ æœåŠ¡å™¨"
                    Command="{Binding AddServerCommand}"
                    Background="{DynamicResource PrimaryBrush}"/>
          </Grid>
        </Border>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="24,0,24,24">
          <ItemsControl ItemsSource="{Binding Servers}">
            <ItemsControl.ItemsPanel>
              <ItemsPanelTemplate>
                <WrapPanel Orientation="Horizontal"/>
              </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="12" Padding="20" Margin="0,0,16,16" Width="320" MinHeight="180">
                  <Grid RowDefinitions="Auto,Auto,*,Auto">
                    <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Margin="0,0,0,12">
                      <TextBlock Grid.Column="0" Text="{Binding Name}" FontSize="18"
                                 FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                      <Ellipse Grid.Column="1" Width="12" Height="12" Margin="8,0,0,0"
                               VerticalAlignment="Center">
                        <Ellipse.Fill>
                          <SolidColorBrush Color="{Binding IsOnline, Converter={x:Static converters:BoolToColorConverter.Instance}}"/>
                        </Ellipse.Fill>
                      </Ellipse>
                    </Grid>
                    <TextBlock Grid.Row="1" Text="{Binding FullAddress}" FontSize="13"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               TextTrimming="CharacterEllipsis" Margin="0,0,0,12"/>
                    <StackPanel Grid.Row="2" Margin="0,0,0,12">
                      <TextBlock FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,4"
                                 IsVisible="{Binding IsOnline}">
                        <Run Text="å»¶è¿Ÿ: "/><Run Text="{Binding FormattedPing}"/>
                      </TextBlock>
                      <TextBlock FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"
                                 IsVisible="{Binding IsOnline}">
                        <Run Text="çŽ©å®¶: "/><Run Text="{Binding FormattedPlayers}"/>
                      </TextBlock>
                    </StackPanel>
                    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
                      <Button Content="è¿žæŽ¥" Background="{DynamicResource PrimaryBrush}"
                              Padding="12,6" Margin="0,0,8,0"
                              Command="{Binding $parent[ItemsControl].((vm:ServersViewModel)DataContext).ConnectServerCommand}"
                              CommandParameter="{Binding}"/>
                      <Button Content="ç¼–è¾‘" Padding="12,6" Margin="0,0,8,0"
                              Command="{Binding $parent[ItemsControl].((vm:ServersViewModel)DataContext).EditServerCommand}"
                              CommandParameter="{Binding}"/>
                      <Button Content="åˆ é™¤" Padding="12,6" Foreground="#DC3545"
                              Command="{Binding $parent[ItemsControl].((vm:ServersViewModel)DataContext).DeleteServerCommand}"
                              CommandParameter="{Binding}"/>
                    </StackPanel>
                  </Grid>
                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </ScrollViewer>

        <StackPanel Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center"
                    IsVisible="{Binding IsEmpty}">
          <TextBlock Text="ðŸ–¥ï¸" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16"
                     Foreground="{DynamicResource TextSecondaryBrush}"/>
          <TextBlock Text="æš‚æ— æœåŠ¡å™¨" FontSize="18" FontWeight="SemiBold"
                     HorizontalAlignment="Center" Margin="0,0,0,8"
                     Foreground="{DynamicResource TextSecondaryBrush}"/>
          <TextBlock Text="ç‚¹å‡»ã€Œæ·»åŠ æœåŠ¡å™¨ã€æŒ‰é’®æ·»åŠ æ‚¨å–œæ¬¢çš„æœåŠ¡å™¨" FontSize="13"
                     HorizontalAlignment="Center"
                     Foreground="{DynamicResource TextTertiaryBrush}"/>
        </StackPanel>

        <!-- æ·»åŠ æœåŠ¡å™¨å¯¹è¯æ¡† -->
        <Border Grid.Row="0" Grid.RowSpan="2"
                Background="#80000000"
                IsVisible="{Binding IsAddServerDialogOpen}"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch">
          <Border Background="{DynamicResource SurfaceElevatedBrush}"
                  CornerRadius="12" Padding="24"
                  Width="400" HorizontalAlignment="Center" VerticalAlignment="Center">
            <StackPanel Spacing="16">
              <TextBlock Text="æ·»åŠ æœåŠ¡å™¨" FontSize="18" FontWeight="Bold"/>
              
              <StackPanel Spacing="12">
                <StackPanel Spacing="4">
                  <TextBlock Text="æœåŠ¡å™¨åç§°" FontSize="13"/>
                  <TextBox Text="{Binding AddServerDialog.Name}" Watermark="è¾“å…¥æœåŠ¡å™¨åç§°"/>
                </StackPanel>
                
                <StackPanel Spacing="4">
                  <TextBlock Text="æœåŠ¡å™¨åœ°å€" FontSize="13"/>
                  <TextBox Text="{Binding AddServerDialog.Address}" Watermark="ä¾‹å¦‚: mc.example.com"/>
                </StackPanel>
                
                <Grid ColumnDefinitions="*,12,*">
                  <StackPanel Grid.Column="0" Spacing="4">
                    <TextBlock Text="ç«¯å£" FontSize="13"/>
                    <NumericUpDown Value="{Binding AddServerDialog.Port}" Minimum="1" Maximum="65535"/>
                  </StackPanel>
                  
                  <StackPanel Grid.Column="2" Spacing="4">
                    <TextBlock Text="åˆ†ç»„ï¼ˆå¯é€‰ï¼‰" FontSize="13"/>
                    <TextBox Text="{Binding AddServerDialog.Group}" Watermark="è¾“å…¥åˆ†ç»„å"/>
                  </StackPanel>
                </Grid>
              </StackPanel>
              
              <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                <Button Content="å–æ¶ˆ" Command="{Binding CancelAddServerCommand}" Classes="outline"/>
                <Button Content="ç¡®å®š" Command="{Binding ConfirmAddServerCommand}" Background="{DynamicResource PrimaryBrush}"/>
              </StackPanel>
            </StackPanel>
          </Border>
        </Border>

        <!-- ç¼–è¾‘æœåŠ¡å™¨å¯¹è¯æ¡† -->
        <Border Grid.Row="0" Grid.RowSpan="2"
                Background="#80000000"
                IsVisible="{Binding IsEditServerDialogOpen}"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch">
          <Border Background="{DynamicResource SurfaceElevatedBrush}"
                  CornerRadius="12" Padding="24"
                  Width="400" HorizontalAlignment="Center" VerticalAlignment="Center">
            <StackPanel Spacing="16">
              <TextBlock Text="ç¼–è¾‘æœåŠ¡å™¨" FontSize="18" FontWeight="Bold"/>
              
              <StackPanel Spacing="12">
                <StackPanel Spacing="4">
                  <TextBlock Text="æœåŠ¡å™¨åç§°" FontSize="13"/>
                  <TextBox Text="{Binding EditServerDialog.Name}"/>
                </StackPanel>
                
                <StackPanel Spacing="4">
                  <TextBlock Text="æœåŠ¡å™¨åœ°å€" FontSize="13"/>
                  <TextBox Text="{Binding EditServerDialog.Address}"/>
                </StackPanel>
                
                <Grid ColumnDefinitions="*,12,*">
                  <StackPanel Grid.Column="0" Spacing="4">
                    <TextBlock Text="ç«¯å£" FontSize="13"/>
                    <NumericUpDown Value="{Binding EditServerDialog.Port}" Minimum="1" Maximum="65535"/>
                  </StackPanel>
                  
                  <StackPanel Grid.Column="2" Spacing="4">
                    <TextBlock Text="åˆ†ç»„ï¼ˆå¯é€‰ï¼‰" FontSize="13"/>
                    <TextBox Text="{Binding EditServerDialog.Group}"/>
                  </StackPanel>
                </Grid>
              </StackPanel>
              
              <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                <Button Content="å–æ¶ˆ" Command="{Binding CancelEditServerCommand}" Classes="outline"/>
                <Button Content="ä¿å­˜" Command="{Binding ConfirmEditServerCommand}" Background="{DynamicResource PrimaryBrush}"/>
              </StackPanel>
            </StackPanel>
          </Border>
        </Border>
          </Grid>
        </ScrollViewer>
      </Grid>

      <!-- æ’ä»¶æ ‡ç­¾é¡µæ˜¾ç¤ºåŒºåŸŸ -->
      <ScrollViewer VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled"
                    Padding="24">
        <ScrollViewer.IsVisible>
          <MultiBinding Converter="{x:Static converters:TabContentTypeConverter.Instance}" ConverterParameter="PluginTabViewModel">
            <Binding Path="#MoreViewControl.DataContext.Tabs"/>
            <Binding Path="#MoreViewControl.DataContext.SelectedTabIndex"/>
          </MultiBinding>
        </ScrollViewer.IsVisible>
        <ContentPresenter>
          <ContentPresenter.Content>
            <MultiBinding Converter="{x:Static converters:SelectedTabContentConverter.Instance}">
              <Binding Path="#MoreViewControl.DataContext.Tabs"/>
              <Binding Path="#MoreViewControl.DataContext.SelectedTabIndex"/>
            </MultiBinding>
          </ContentPresenter.Content>
        </ContentPresenter>
      </ScrollViewer>
    </Grid>
  </Grid>
</UserControl>
